Description: fix permissions bypass via format string
Origin: upstream, http://www.sudo.ws/sudo/alerts/sudo_debug.html

Index: sudo-1.8.3p1/src/sudo.c
===================================================================
--- sudo-1.8.3p1.orig/src/sudo.c	2011-10-21 09:01:26.000000000 -0400
+++ sudo-1.8.3p1/src/sudo.c	2012-01-31 10:25:40.992701202 -0500
@@ -1208,15 +1208,15 @@
 sudo_debug(int level, const char *fmt, ...)
 {
     va_list ap;
-    char *fmt2;
+    char *buf;
 
     if (level > debug_level)
 	return;
 
-    /* Backet fmt with program name and a newline to make it a single write */
-    easprintf(&fmt2, "%s: %s\n", getprogname(), fmt);
+    /* Bracket fmt with program name and a newline to make it a single write */
     va_start(ap, fmt);
-    vfprintf(stderr, fmt2, ap);
+    evasprintf(&buf, fmt, ap);
     va_end(ap);
-    efree(fmt2);
+    fprintf(stderr, "%s: %s\n", getprogname(), buf);
+    efree(buf);
 }
